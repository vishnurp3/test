classpath:/payload-request/factorModelData/getClimateQuestionKeyList_CTPA_PHF_1_2__CRS_SRI_1_2.json

import org.junit.Assert;
import org.junit.Test;

import java.io.IOException;
import java.util.List;
import java.util.Map;

public class ClimateQuestionKeyListIT extends BaseIT { // or whatever your test class is

    @Test
    public void testGetClimateQuestionKeyList_forCtpaPhf12_andCrsSri12() throws IOException {
        // arrange
        String requestJson = CDFServiceUtilsTest.getRequestJsonFromFile(
                "classpath:/payload-request/factorModelData/getClimateQuestionKeyList_CTPA_PHF_1_2__CRS_SRI_1_2.json");

        resp = callAPIWithRequestBody(
                createURLWithPort(CDFServiceEndpoints.GET_CLIMATE_QUESTION_KEY_LIST),
                requestJson,
                200);

        // act
        Map<String, List<String>> ctpaModelInputs =
                resp.getBody().jsonPath().get("ctpaModelInputs");
        Map<String, List<String>> ctpaCalculationBreakdown =
                resp.getBody().jsonPath().get("ctpaCalculationBreakdown");
        Map<String, List<String>> crsModelInputs =
                resp.getBody().jsonPath().get("crsModelInputs");
        Map<String, List<String>> crsCalculationBreakdown =
                resp.getBody().jsonPath().get("crsCalculationBreakdown");

        // assert – first, basic null / non-empty checks (same spirit as existing tests)
        Assert.assertNotNull("ctpaModelInputs must not be null", ctpaModelInputs);
        Assert.assertNotNull("ctpaCalculationBreakdown must not be null", ctpaCalculationBreakdown);
        Assert.assertNotNull("crsModelInputs must not be null", crsModelInputs);
        Assert.assertNotNull("crsCalculationBreakdown must not be null", crsCalculationBreakdown);

        Assert.assertFalse("ctpaModelInputs must not be empty", ctpaModelInputs.isEmpty());
        Assert.assertFalse("ctpaCalculationBreakdown must not be empty", ctpaCalculationBreakdown.isEmpty());
        Assert.assertFalse("crsModelInputs must not be empty", crsModelInputs.isEmpty());
        Assert.assertFalse("crsCalculationBreakdown must not be empty", crsCalculationBreakdown.isEmpty());

        // assert – slightly stronger, but still simple & framework-friendly

        // CTPA inputs
        Assert.assertTrue(ctpaModelInputs.containsKey("crs_ctp_generic_key"));
        Assert.assertTrue(ctpaModelInputs.containsKey("ctp_ce"));
        Assert.assertTrue(ctpaModelInputs.containsKey("ctp_ert"));
        Assert.assertTrue(ctpaModelInputs.containsKey("ctp_tp"));
        Assert.assertTrue(ctpaModelInputs.containsKey("ctp_fs"));

        // One representative field check – not too brittle, but proves mapping is correct
        Assert.assertTrue(ctpaModelInputs.get("ctp_ce").contains("no_of_units"));

        // CTPA calculation breakdown
        Assert.assertTrue(ctpaCalculationBreakdown.containsKey("ctp_ce"));
        Assert.assertTrue(ctpaCalculationBreakdown.containsKey("ctp_ert"));
        Assert.assertTrue(ctpaCalculationBreakdown.containsKey("ctp_tp"));
        Assert.assertTrue(ctpaCalculationBreakdown.containsKey("ctp_fs"));

        Assert.assertTrue(ctpaCalculationBreakdown.get("ctp_ce")
                .contains("Scope_1_2_current_emission_intensity"));

        // CRS inputs
        Assert.assertTrue(crsModelInputs.containsKey("crs_tri"));
        Assert.assertTrue(crsModelInputs.containsKey("crs_trm"));
        Assert.assertTrue(crsModelInputs.containsKey("crs_pri"));
        Assert.assertTrue(crsModelInputs.containsKey("crs_prm"));

        // CRS calculation breakdown
        Assert.assertTrue(crsCalculationBreakdown.containsKey("crs_tri"));
        Assert.assertTrue(crsCalculationBreakdown.containsKey("crs_trm"));
        Assert.assertTrue(crsCalculationBreakdown.containsKey("crs_pri"));
        Assert.assertTrue(crsCalculationBreakdown.containsKey("crs_prm"));
        Assert.assertTrue(crsCalculationBreakdown.containsKey("crs_fs"));

        Assert.assertTrue(crsCalculationBreakdown.get("crs_fs")
                .contains("finalCRSScore"));
    }
}
